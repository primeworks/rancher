| multisearch

[ search source="*shell*.csv" index="sfx" sourcetype="csv"
| rename Amt as Price, "State_ Prov" as Province, "Location Name" as Location, Qty as Quantity, "Unit Price" as Cost
| eval Provider="Shell"
]

[ search source="*flyingj*.csv" index="sfx" sourcetype="csv"
| rename Amt as Price, "State_ Prov" as Province, "Location Name" as Location, Qty as Quantity, "Unit Price" as Cost
| eval Provider="Flying J"
]

[ search source="*irving*.csv" index="sfx" sourcetype="csv"
| rename Amt as Price, "State_ Prov" as Province, "Location Name" as Location, Qty as Quantity, "Unit Price" as Cost
| eval Provider="Irving"
]

[ search source="*pipeline*.csv" index="sfx" sourcetype="csv"
| rename Montant as Price, Prov as Province, "Description site" as City, "Description site" as Location, Quantit as Quantity
| eval Provider="Pipeline"
]

[ search source="*bvd*.csv" index="sfx" sourcetype="csv"
| rename "Final Amount" as Price, "Prov_ST Abb" as Province, "Site City" as City, "Site" as Location, "Billed PPU" as Cost
| where UOM="L"
| eval Provider="BVD"
]

[ search source="*bvd*.csv" index="sfx" sourcetype="csv"
| rename "Prov_ST Abb" as Province, "Site City" as City, "Site" as Location, "Final Amount" as uCost, "Exchange Rate" as exchange
| where UOM="G"
| eval Provider="BVD Loves", Date=strftime(_time, "%y-%m-%d"), Gallons=sum(Quantity), volume-g=Gallons*3.78541, exr=exchange-1, Price=uCost*exchange
]

[ search index="sfx"
| eval fuelLtrs=FulUsd*3.78541
| fields Unit, Dist, FulUsd, fuelLtrs
]

[search index="sfx" 
| where Currency="US"
| rename "Total Fuel QTY" as totalFuelus
| fields totalFuelus
]


[search index="sfx" 
| where Currency="CAD"
| rename "Total Fuel QTY" as totalFuelca
| fields totalFuelca
]


[search index="sfx" 
| rename FulUsd as tBurn
| fields tBurn
]

| fields Unit, Dist, FulUsd, fuelLtrs, totalFuelus, totalFuelca, tBurn, Provider, Price, Province, City, Location, Date, Quantity, Country, Cost
